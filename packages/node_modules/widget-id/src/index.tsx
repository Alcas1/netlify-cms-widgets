import * as React from 'react'
import { useState, useEffect } from 'react'
import shortid from 'shortid'
import { WidgetProps } from 'types'

export const IdWidget: React.FC<WidgetProps> = ({
  value,
  field,
  onChange,
  forID,
  classNameWrapper,
  setActiveStyle,
  setInactiveStyle,
}) => {
  const [ id, setId ] = useState('')
  useEffect(() => {
    if (value) return

    const prefix = field.get('prefix')
    const id = `${prefix ? prefix + '-' : ''}${shortid()}`
    onChange(id)
    setId(id)
  }, [value])

  return (
    <input
      type="text"
      className={classNameWrapper}
      style={{
        opacity: 0.4,
      }}
      value={value || id}
      // value={value}
      id={forID}
      onFocus={setActiveStyle}
      onBlur={setInactiveStyle}
      disabled
    />
  )
}